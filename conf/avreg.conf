#########################  ru_RU.UTF-8  #################################
#                                                                       #
#  Главный конфигурационный файл программы видео/аудио регистрации      #
#                            AVReg 6.0                                  #
#                                                                       #
#  Права и путь по-умолчанию:  root.root 0644 /etc/avreg/avreg.conf     #
#                                                                       #
#  Строки, начинающиеся с символов "#" или ";" являются                 #
#  комментариями и игнорируются.                                        #
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++#

### Общие настройки для всего набора приложений AVReg ###

# Название видео сервера
server-name = "См. параметр server-name"

# Контактные данные администратора сервера AVReg
; admin-name = 'Your name'
; admin-mail = 'your@email'
; admin-tel  = '+7 111 222 333'

# Путь до файла лицензионного ключа защиты.
# По умолчанию: "не установлено"
; key = '/etc/avreg/avreg5KEY356-zsobr'

# Настройки доступка к базе данных.
# Тип sql-клиента/сервера, mysql или pgsql, по-умолчанию: mysql
db-type = "mysql"
# Хост/порт, используемые для подключения,
# по умолчанию: пусто - локальный сервер.
db-host = '192.168.1.14'
# db-port = '3306'
# Имя базы данных, по-умолчанию: avreg6_db
db-name = 'avreg6_db'

# Каталог, в который должны сохраняться аудио/видео файлы.
# По умолчанию: '/var/spool/avreg'
# !!! Если вы измените значение пути по умолчанию,
# не забудьте соответственно изменить значение Alias-а "/avreg/media"
# для веб-сервера Apache2 в файле /etc/avreg/site-apache2-user.conf
; storage-dir = '/home/video'
storage-dir = '/srv/video'

# Системные пользователь/группа, с привилегиями которых ("под которыми")
# будут работать приложения серверной части AVReg - avregd и avreg-unlink.
# Такие же атрибуты "владелец:группа" получат все создаваемые каталоги и файлы.
# Прим. по группе: если при монтировании файловой системы использовалась опция
# grpid (man 8 mount), то группа созданного в ней каталога/файла будет
# установлена значением группы родительского каталога.
# По умолчанию: avreg/avreg
; user  = avreg
; group = www-data

# Имя текстового файла-журнала, в который записываются "вручную"
# удалённые из архива файлы, например, для сокрытия каких-то проишествий.
# Журнал создаётся в каталоге {storage-dir}.
# По умолчанию: "removed-manually.txt"
; removed-manually = 'removed-manually.txt'

avreg-site {
   ### Пользовательские настройки веб-интерфейса, версия 6.1.                ###
   ### Используйте эту секцию для переопределения параметров по-умолчанию    ###
   ### в файле /etc/avreg/site-defaults.php, не изменяйте site-defaults.php  ###

   # Устанавливайте имя "db-user" и пароль "db-passwd" доступа к базе данных
   # в приватном ( 0640 root:www-data ) файле c именем "avreg-site.secret" 
   include /etc/avreg/avreg-site.secret

   # Если используется внешняя аутентификация, то нужно расскоментировать
   # параметр ниже и установить его значение как абсолютное имя файла
   # в котором приведены соответствия: внешний_логин = avreg_логин
   ; ExternalAuthMap = /etc/avreg/ext_auth.map

   # Макс. допустимый таймаут неактивности видеопотока на странице наблюдения
   # за камерами в реальном времени браузерами на движках Gecko (Mozilla Firefox)
   # и Webkit (Chrome, Safari), по истечении которого которого возникает событие
   # "ошибка" и, если настроено в текущей раскладке, запускается алгоритм реконнекта.
   # Значение параметра "online-check-period" следует выбирать не менее
   # чем трехкратной скорости самого медленного видеопотока. Например, если
   # скорость самого медленного видеопотока 1 fps, то приемлимое значение 3 сек.
   # По-умолчанию: 5 сек. Контроль не ведётся если усановлено 0.
   ; online-stream-inactive-timeout = 7

   # Конфигурация AVReg-плеера, используемого для проигрывания медиа
   # потоков на веб-страницах интерфейса AVReg. Формат строка настройки:
   # aplayerConfig['OS']['BROWSER']['BR_VER']['PROTOCOL']['FORMAT'] = 'PLAYER' 
   # где
   #   OS - версия ОС: windows, linux, android, ipad, iphone, mac.
   #   BROWSER - название браузера:
   #                 'mozilla' - Mozilla Firefox.
   #                 'chrome' - Google Chrome, Chomium.
   #                 'opera' - Opera.
   #                 'safari' - Safari.
   #                 'msie' - MS Internet Explorer.
   #   BR_VER - версия браузера (мажорная, первое число).
   #   PROTOCOL - протокол доступа, 'http' или 'rtsp'.
   #   FORMAT - формат медиа-контента
   #            для 'http' - 'mjpg','mjpeg','mp4', 'avi', ...
   #            для 'rtsp' - всегда 'live'
   #   PLAYER - вариант HTML-объекта для воспроизведения:
   #           'embed' - для воспроизведения используются программы-плагины
   #                     установленные пользователем для его браузера,
   #           'video' - для воспроизведения используются html5-элемент <video>,
   #           'audio' - для воспроизведения используются html5-элемент <audio>,
   #           'image' - используется html-элемент <img>,
   #           'mjpeg' - используется html-элемент <img> для motion jpeg,
   #           'VLC'   - для воспроизведения используются VLC-player,
   #           'flowplayer' - для воспроизведения используются flowplayer flash.
   #                          Позволяет использовать псевдостриминг.
   ; aplayerConfig['*']['*']['*']['http']['mp4'] = 'flowplayer'
   ; aplayerConfig['*']['*']['*']['http']['flv'] = 'flowplayer'

   # Статический список записываемых камер, независимый от текущего
   # значения параметра "rec_mode" в настройках камеры (раздел "Запись").
   # Нужен для доступа к архиву через веб-интерфейсы Архив::Плейлист и
   # Архив::Галерея в периоды, когда "rec_mode" = "выкл."
   # (обычно при записи по расписанию через CRON).
   ; recordable_camlist = 1-5, 6, 10-99

   # Разрешения видеокадров с камер, доступные для просмотра
   # на странице, оптимизированной для мобильных и PDA устройств.
   ; pda_resolutions = "160x120, 320x240, fs, 1:1"

   # Опции доступа к http-серверу avregd. Могут быть полезными,
   # если используются несколько профилей avregd (несколько процессов на разных портах)
   # или видеосервер закрыт фронтэндом (например, apache2 + mod_rewrite + mod_proxy).
   ; avregd-httpd = 'http://$_SERVER[SERVER_NAME]:874'

   # НЕ HTTP-шные URL префиксы для загрузки медиа-файлов с удалённых хостов.
   # Общий шаблон: murl-pre-OS[CLIENTS_IP_ACL] = 'PROTO://HOST:PORT/PATH'
   #   где:
   #     OS - "win"(dows), "nix" - unix-based or "other"
   # Прокотолы доступа к медиа-файлам по-умолчанию: "http://"
   # Для некоторых протоколов возможно потребуется дополнительная настройка
   # браузеров, см. http://avreg.net/manual_applications_media-access.html#browser
   # Примеры:
   ; murl-pre-win['192.168.55.0/24'] = 'file:///\\\\hostname\\AVReg'
   ; murl-pre-win['10.0.0.0/8']      = 'file:///Z:\\AVReg'
   ; murl-pre-nix['192.168.0.0/16']  = 'smb://hostname/avreg'
   ; murl-pre-other['any']           = 'ftp://192.168.1.1/avreg'
   ; murl-pre-nix['localhost']       = 'file:///var/spool/avreg'

   # Абсолютный путь до включаемого php-кода, выполняемого при получении
   # HTTP уведомлений, например, при "сработке" дискретных входов ip-камер.
   # По умолчанию, этот параметр указывает на наш рабочий пример
   # "/usr/share/avreg-site/on-http-notify.inc.php", который позволяет
   # только отображать "внешние" тревоги в локальном просмотрщике камер
   # avreg-mon и только в одно-дисплейной конфигурации.
   # См. также http://avreg.static/manual_applications_on-http-notify.html 
   ; on-http-notify = /etc/avreg/scripts/on-http-notify.inc.php
}

avreg-unlink {
   ### Настройки "чистильщика" архива от старых медиа-файлов (версия 6.1),   ###
   ### автоматически запускаемого системным шедулером CRON по расписанию:    ###
   ### см. файл-задание "/etc/cron.d/avreg-unlink"                           ###
   ### Значениями параметров start-space и end-space, в сочетании с частотой ###
   ### запуска "чистильщика", вы должны предотвратить 100% заполнение        ###
   ### дискового устройства используемого для записи файлов, и тем самым     ###
   ### останов процесса записи. Значениями параметров del-per-once и timeout ###
   ### вы должны предотвратить пиковую перегрузку системы вызванную          ###
   ### процессом удаления файлов с файловой системы и записей в базе данных. ###

   #    Устанавливайте имя "db-user" и пароль "db-passwd" доступа к базе данных
   # в приватном ( 0600 root:root ) файле c именем "avreg-unlink.secret" 
   include /etc/avreg/avreg-unlink.secret

   #    Команда для получения размеров диска в 1КБ блоках,
   # требуемый stdout вывод: "1Kблоков_ИСПОЛЬЗОВАНО 1Kблоков_ВСЕГО",
   # Параметр "disk-usage-cmd" предназначен прежде всего для ипользования
   # дисковых системных квот quota(1)/quotactl(2) или xfs_quota(8).
   # В команде можно использовать переменные:
   #  - @USER/@GROUP - раскрываются как "user"/"group" в avreg.conf;
   #  - @DIR/@FS/@MNTPOINT - раскрываются как имя каталога "storage-dir"
   #   в avreg.conf, имя блочного устройства и точка монтирования, соотв.
   # По умолчанию: не задано, т.е. будет использоваться вызов statfs(2)
   # Для ext3/ext4 файловых систем смонтированных с опцией "usrquota":
   ; disk-usage-cmd = "quotatool -b -u @USER -d @MNTPOINT | awk '{ print $3,$5 }'"
   # Для XFS файловой системы смонтированной с опцией "uquota":
   ; disk-usage-cmd = "xfs_quota -c 'quota -vbN @USER' | awk '{ print $2,$4 }'"

   #    В трёх нижеследующих параметрах допустимо использование
   # суффиксов-модификаторов: k[ило], M[ега] and G[ига] байт,
   # например: 2500M or 1G (пишите латинскими буквами и слитно)
   #    Для "-space" опций вы пожете также задавать знаяения в процентах,
   # от общего размера устройства "storage-dir".

   #    Размер свободного места на архивном устройстве,
   # при котором начинается процесс очистки.
   # По умолчанию: остаток - '10%', суффикс-модификатор - 'G'(Гигабайт)
   ; start-space = 35G

   #    Размер свободного места на архивном устройстве,
   # при котором заканчивается процесс очистки.
   # Рекомендуется устанавливать не менее чем 1,5 размера start-space
   # По умолчанию: остаток - '15%', суффикс-модификатор - 'G'(Гигабайт)
   ; end-space = 50G

   #    Внутри сеанса удаления процесс разбит на небольшие транзакции.
   # Это нужно для того, чтобы не перегрузить систему длительным и непрерывным
   # процессом удаления файлов с жестких дисков (особенно на ext3 или 
   # программных RAID 4,5) одновременно с процессом записи новых файлов.
   # В рамках одной транзакции удаляется набор файлов с общим размером
   # не более чем значение "del-per-once".
   # По умолчанию: удалять по 500M, суффикс-модификатор - 'M'(Мегабайт)
   ; del-per-once = 1G

   #    Перерыв между транзакциями timeout в секундах,
   # по умолчанию: 0.3 сек., допустимый диапазон значений: [0.1-1.0].
   ; timeout = 0.5

   #    Читать за один раз rows-per-select записей из таблицы EVENTS.
   # Если не очень понимаете зачем нужен этот параметр - не трогайте.
   # По умолчанию: 5000
   ; rows-per-select = 10000

   #    Не удалять записи и файлы новее чем "select-now-minus" минут.
   # Поставьте как максимальное возможное значение длительности (mtime - ctime)
   # медиа-файлов (см. V.max_minutes и A.max_minutes) с небольшим запасом.
   # По умолчанию: 60 минут (1 час.)
   ; select-now-minus = 120
}

avregd {
   ### настройки демона avregd версии 6.1 ###

   # Параметры доступа к базе данных "db-user" и "db-passwd" сохранены
   # в приватном файле, включённом ниже:
   include "/etc/avreg/avregd.secret"

   # Переключить выполнение процесса на процессор (ЦПУ) с номером "cpu".
   # Номера (идентификаторы) процессоров смотрите в файле /proc/cpuinfo"
   # в поле "processor".
   # По умолчанию не установлено: использовать текущий CPU не переключаясь.
   ; cpu = 3

   # avregd будет работать только с устройствами под номерами,
   # указанными в "devlist". Значение параметра "devlist" должно представлять
   # собой строку номеров устройств, разделённых запятыми.
   # По умолчанию не установлено, т.е. работать с всеми активными (`work'=`Вкл.')
   # устройствами.
   ; devlist = 1,3,5-10,25

   # Права доступа (man 1 chmod) на создаваемые в {storage-dir} каталоги и файлы.
   # Значения по умолчанию: 0775/0644 для "dirs-mode" и "files-mode" соответственно.
   ; dirs-mode  = 0770
   ; files-mode = 0640

   # Максимальное количество файлов в одном каталоге для одной камеры
   # (см. описатель "%L" в описании параметра "dirs-name-fmt" ниже).
   # Допустимые значания [50..1000], по умолчанию: 500.
   ; max-files-per-dir = 100

   # Форматы имён каталогов и медиа-файлов, создаваемых в каталоге {storage-dir}.
   # Обычные символы [A-Za-z_-./] копируются без преобразований.
   # Описатели преобразования предваряются символом "%":
   #   %V - номер камеры;
   #   %О - название камеры (параметр text_left);
   #   %W - последние две цифры текущей сессии движения или принудительной записи;
   #   %t - номер кадра в секунде (только для отдельных кадров JPEG);
   #   %a,%b,%d,%H,%m,%S,%w,%y,%Y - описатели преобразования даты/времени
   #        (создания файла) функции strftime(3) языка С (man 3 strftime);
   #   %f - расширение файла (jpg, avi, ...);
   #   %L - используется для перехода на новые подкаталоги "nextXXXX"
   #         при превышении кол-ва файлов в текущем каталоге значения
   #         определенного параметром "max-files-per-dir",
   #         !!! должно быть последним параметром.
   # Недопустимые символы заменяются на символ "_".
   # !!! Для предотвращения потери записанной информации (перезаписи файлов), помните:
   #      * именно использованием временных описателей в форматах вы обеспечиваете
   #        уникальность имени файла;
   #      * очень важно обеспечить "плавный" ход системного времени, рекомендуем
   #        использовать NTP с 128ms шагом коррекции и не менять время "вручную" вовсе.
   ; dirs-name-fmt = "%Y-%m/%d/%V-%O%L"
   ; jpeg-name-fmt = "%H_%M_%S-%t.%f"
   ; av-name-fmt   = "%H_%M_%S.%f"

   # Принимать http запросы на этих сетевых интерфейсах.
   # Допустимо указывать список IP-адресов или имен интерфейсов,
   # разделённых запятыми или пробелами, например: "lo, eth1, 192.168.0.3".
   # По умолчанию не установлено: принимать на всех активных интерфейсах.
   ; listen-addr = "lo, eth1"

   # Принимать http запросы на этом порту. По умолчанию: 874
   ; http-port = 81

   # Осуществлять исходящие сетевые соединения к сетевым камерам
   # с этого адреса. АДРЕС можно быть указан как IP-адрес или
   # как имя сетевого интерфейса.
   # По умолчанию не установлено: решение принимает сетевой стек 
   # операционной системы системы.
   ; bind-addr = eth1

   # Внешний скрипт (канал pipe) для сбора событий.
   # event-collector = "PATH[,W[,R]]", где
   #    PATH - абсолютный путь до скрипта,
   #  опциональные значения W и R являются таймаутами в секундах:
   #    W - ожидания завершение скрипта при завершении демона,
   #        значение 0 - не ждать, по-умолчанию: ждать 2 секунды;
   #    R - respawn таймаут для перезапуска,
   #        минимум - 3 секунды, по-умолчанию: 5 секунд.
   # См. также: http://avreg.net/manual_applications_avregd-event-collector.html
   # По умолчанию: не задан, т.е. не уведомлять о событиях.
   ; event-collector = "/etc/avreg/scripts/event-collector"

   # Не записывать события (включая ссылки на записанные файлы)
   # в таблицу EVENTS. Если значение установлено в true, yes или 1,
   # запись в таблицу EVENTS не производится и это делает невозможным
   # использование штатного средства очистки архива avreg-unlink
   # для обеспечения непрерывной записи в циклический архив
   # и доступ к записанным медиа-файлам через веб-интерфейс.
   # По умолчанию: записывать события в таблицу EVENTS.
   ; db-disable-events = уes
}

avreg-mon {
   ### настройки локального просмотрщика камер в реальном времени ###
   ### версия 6.1 ###

   # Устанавливайте имя "db-user" и пароль "db-passwd" доступа к базе данных
   # в приватном ( 0640 root:video ) файле c именем "avreg-mon.secret" 
   include /etc/avreg/avreg-mon.secret

   # Использовать раскладки для левого(L) или правого(R) дисплея 
   # на двух-мониторных системах.По умолчанию: "L" (левый или единственный).
   ; display = R

   # После запуска переключиться на раскладку с номером layout 
   # Cм. настройку раскладок в веб-интерфейсе. По умолчанию: 0.
   ; layout = 1

   # Использовать окно с разрешением ШИРИНАxВЫСОТА пикселей.
   # По умолчанию: 648x488
   ; geo = 800x600

   # Использовать весь экран. По умолчанию: no
   ; fullscreen = yes

   # Cоздать окно без заголовка (title bar) и рамок (frame), если такое возможно.
   # Установка fullscreen в "yes" автоматически включает этот флаг.По умолчанию: no 
   ; no-winframe = yes

   # Не пытаться сохранять пропорции (соотношение сторон видеокадра или aspect ratio)
   # видео с камер, просто использовать всё доступное пространство окна программы.
   # Такой режим может приводить к увеличению нагрузки на систему и небольшим 
   # искажениям. По умолчанию: "no", т.е. использовать для всех камер соотношение строн 
   # как у камеры в главном окне раскладки.
   ; fit2screen = yes

   # Сохранять огигинальные пропорции для всех камер. Не действует если установлено
   # "fit2screen=yes". По умолчанию: "no", т.е. использовать для всех камер соотношение
   # строн как у камеры в главном окне раскладки.
   ; keep-aspect = yes

   # Использовать заданные пропорции для всех камер. Не действует если установлено
   # "fit2screen=yes". По умолчанию: "no", т.е. использовать для всех камер соотношение
   # строн как у камеры в главном окне раскладки.
   ; force-aspect = 16:9

   # Использовать целочисленные коэффициенты масштабирования (..., 1/3, 1/2, 1, 2, ...)
   # при выводе изображения для снижения нагрузки на Intel-процессоры при программном
   # видеовыводе.  По умолчанию: no.
   ; smart-scale = yes

   ### настройки интерфейса пользователя ###
   # Заблокировать (не использовать) мышь, клавиатуру или оба устройства.
   # Следуем также установить в "yes", если мышь/клавиатура отсуствуют.
   # По умолчанию: no
   ; no-mouse = yes
   ; no-keyboard = yes
   ; no-tty = yes

   # Заблокировать действия по нажатию клавиш клавиатуры,
   # чьи коды (см. SDL_keysym.h), указанные через запятую, присутствуют в этом списке.
   ; http://www.google.com/search?q=site:www.libsdl.org+SDL_keysym.h
   ; Например, блокирование клавиш <ESC>,<Q>,<X>,<F1>,<4>-<9> и <4>-<9> на нумпаде:
   ; disable-keys = '27,113,120,282,52-57,260-265'

   # Период попыток восстановления связи с демоном avregd (например, при его перезапуске)
   # в секундах. Если значение параметра установлено как 0, то при обрыве связи с демоном,
   # avreg-mon завершит работу с сообщением об ошибке. По умолчанию: 2 сек.
   ; reconnect-timeout = 3

   # Таймаут выдачи предупредительного сигнала "НЕТ СИГНАЛА" в сек. По умолчанию: 4 сек. 
   ; no-signal = 4

   # Таймаут (в сек.) отображения камеры, выдвинутой (действиями оператора)
   # на  передний план и распахнутой во весь экран или окно приложения.
   # По умолчанию: 300 сек. 0 - не выходить автоматически из такого режима.
   ; fs-timeout = 300

   # Таймаут отображения названия камеры крупным шрифтом в сек.
   # Если 0 - отображать название камер постоянно. По умолчанию: 6 сек.
   ; camname-timeout = 6

   # Таймаут отображения курсора в сек. Если 0 - не скрывать курсор. По умолчанию: 4 сек.
   ; cursor-timeout = 4


   ### Настройки удалённого управления ###
   # Разрешить удалённое управление согласно "remote-control".
   # Значение "remote-control" должно быть вида "http://HOST:PORT/PATH-PREFIX".
   # HOST можно указывать как ip-адрес, хост-имя или "*" как "любой".
   # Пример: при указании "http://192.168.0.1:8155/avreg-mon-cgi", avreg-mon
   # будет слушать HTTP запросы на адресе 192.168.0.1 и 8155 порту.
   # Замечание: значение PORT будет автоматически увеличено на 1 если display='R'
   # См. также: http://avreg.net/manual_tuning_avreg-mon.html#rctrl
   # По умолчанию: <пусто> - запретить удалённое управление.
   ; remote-control = 'http://192.168.0.1:8155/avreg-mon-cgi'

   # Принимать запросы только с хостов и(или) сетей, указанных в списке "allowed-from".
   # Пример: "localhost, 192.168.43.0/24, 10.0.0.0/8".
   # По умолчанию: <пусто> - принимать заросы с любых хостов.
   ; allowed-from = '192.168.0.0/24'

   # Список сообщений тревог. Макс. количесво сообщений - 4, макс. длина одного сообщения - 15.
   # CGI-запрос "/camera?nr=N&param=alarm&action=set&value=CODE"
   # отобразит сообщение #CODE(начинается с 0) в правом верхнем углу окна соотв. камеры.
   # По умолчанию: <пусто> - не отображать сообщения тревог.
   ; alarm-msgs = ' были тревоги ; ВСКРЫТ КОРПУС ; РАЗРЯД БАТАРЕИ '
 
   ### Специфические настройки видеовывода.                                           ###
   ### Предупреждение: установка этих параметров может значительно увеличить нагрузку ### 
   ### на систему, несмотря на кажущуюся пользу от включения некоторых режимов.       ###
   # Попытаться создавать графические элементы прямо в видео-памяти видеокарты.
   ; hw-surface = yes

   # Выводить YUV оверлеи прямо в видео-память видеокарты, если возможно.
   ; yuv-direct = yes

   # Использовать аппаратное YUV ускорение видеовывода, если возможно. 
   ; yuv-hwaccel = yes

   # Использовать IYUV оверлей вместо YV12 (по умолчанию).
   ; iyuv = yes

   # Попытаться использовать режим с двойными аппаратными видеобуферами.
   ; doublebuf = yes

   # Включает асинхронное обновление экрана. Обычно _замедляет_ работу на
   # однопроцессорных системах, но _может_ ускорить видеовывод на
   # многопроцессорных SMP системах. По умолчанию: no
   ; asyncblit = yes
}
